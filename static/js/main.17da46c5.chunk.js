(this["webpackJsonpbsuir-additional-api"]=this["webpackJsonpbsuir-additional-api"]||[]).push([[0],{141:function(e,t,n){e.exports=n.p+"static/media/logo.e4b29469.png"},146:function(e,t,n){e.exports=n(366)},151:function(e,t,n){},235:function(e,t,n){},237:function(e,t,n){},284:function(e,t,n){},285:function(e,t,n){},365:function(e,t,n){},366:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(30),o=n.n(c),s=(n(151),n(12)),i=n(23),u=n(8),l=n(64),p=n(144),m=n(119),f=n(11),d=n.n(f),h=n(16),b=n(14),g=n(139),w=n.n(g),O={EmptyRoute:"/",MainRoute:"/news",Erud:"/erad",Rating:"/rating",Files:"/files",FreeRooms:"/free-rooms"},v={AUTH:"auth/auth",LOGOUT:"auth/logout"},j=n(65),E=n(45),y=n.n(E),k="http://54.91.104.127:9000/bsuir/api/v1",N={auth:function(){var e=Object(j.a)(d.a.mark((function e(t,n){var a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get("".concat(k,"/auth?login=").concat(t,"&password=").concat(n));case 2:200===(a=e.sent).status&&(r=a.data.token,y.a.defaults.headers.common.Authorization="Bearer ".concat(r),localStorage.setItem("authToken",r));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()};!function(){var e=localStorage.getItem("authToken");e&&(y.a.defaults.headers.common.Authorization="Bearer ".concat(e))}();var x=n(66),A=n(71);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(n,!0).forEach((function(t){Object(x.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z={userId:null,token:null},T=Object(A.a)({name:"auth",initialState:z,reducers:{setAuthData:function(e,t){var n=t.payload;return S({},e,{token:n.token,userId:n.userId})},logout:function(){return S({},z)},auth:function(e){e.login,e.password}}}),R=T.actions,D=T.reducer,I=n(70),F=function(e){return I.b.error("\ud83e\udd26\u200d\u2642\ufe0f"+e)},M=d.a.mark(L),B=d.a.mark(W),U=d.a.mark(H),G=d.a.mark(J);function L(){var e,t,n;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!(e=localStorage.getItem("authToken"))){a.next=6;break}return t=w()(e),n=t.userId,a.next=6,Object(h.d)(R.setAuthData({token:e,userId:n}));case 6:a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),console.error("checkAuthStatusSaga error",a.t0);case 11:case"end":return a.stop()}}),M,null,[[0,8]])}function W(e){var t;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.prev=1,n.next=4,N.auth(t.login,t.password);case 4:return n.next=6,Object(h.b)(L);case 6:n.next=12;break;case 8:n.prev=8,n.t0=n.catch(1),n.t0.response&&400===n.t0.response.status&&F("Authorization error"),console.error("authSaga error",n.t0);case 12:case"end":return n.stop()}}),B,null,[[1,8]])}function H(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.removeItem("authToken"),e.next=3,Object(h.d)(Object(b.d)(O.EmptyRoute));case 3:case"end":return e.stop()}}),U)}function J(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.a)([Object(h.b)(L),Object(h.e)(v.AUTH,W),Object(h.e)(v.LOGOUT,H)]);case 2:case"end":return e.stop()}}),G)}var $=J,_={GET:"news/getNews",UNSET:"auth/clearNews"},q={getNews:function(){var e=Object(j.a)(d.a.mark((function e(t,n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get("".concat(k,"/newsList?page=").concat(t,"&newsAtPage=").concat(n));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()};function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var K={page:0,newsAtPage:0,count:0,news:[]},Q=Object(A.a)({name:"news",initialState:K,reducers:{getNews:function(e){e.page,e.count},setNews:function(e,t){return console.log(e,t),{page:t.payload.page,newsAtPage:t.payload.newsAtPage,count:t.payload.count,news:t.payload.news}},clearNews:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(n,!0).forEach((function(t){Object(x.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},K)},auth:function(e){e.login,e.password}}}),V=Q.actions,X=Q.reducer,Y=d.a.mark(ee),Z=d.a.mark(te);function ee(e){var t,n,a,r;return d.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.payload,n=t.page,a=t.newsAtPage,c.prev=2,c.next=5,q.getNews(n,a);case 5:return r=c.sent,c.next=8,Object(h.d)(V.setNews(r.data));case 8:c.next=13;break;case 10:c.prev=10,c.t0=c.catch(2),c.t0.message.includes("500")?F("Pankratiew server fucked up"):F("Something went wrong");case 13:case"end":return c.stop()}}),Y,null,[[2,10]])}function te(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.a)([Object(h.e)(_.GET,ee)]);case 2:case"end":return e.stop()}}),Z)}var ne,ae=te,re=d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.a)([Object(h.c)($),Object(h.c)(ae)]);case 2:case"end":return e.stop()}}),e)})),ce=n(40),oe=n(371),se=n(19),ie=Object(se.a)(),ue=Object(p.a)(),le=Object(u.createStore)((ne=ie,Object(u.combineReducers)({form:oe.a,router:Object(ce.b)(ne),auth:D,news:X})),Object(l.composeWithDevTools)(Object(u.applyMiddleware)(Object(m.a)(ie),ue)));le.runSaga=function(e){return ue.run(e)},ue.run(re);n(235),n(236),n(237);var pe=n(370),me=n(369),fe=n(142),de=n.n(fe),he=n(31),be=n(141),ge=n.n(be),we=Object(he.cn)("auth-page"),Oe=Object(me.a)({form:"authForm"})((function(){var e=Object(s.d)(),t=de()("authForm"),n=Object(s.e)((function(e){return t(e,"password")})),a=Object(s.e)((function(e){return t(e,"login")}));return r.a.createElement("div",{className:we("container")},r.a.createElement("div",{className:we("content")},r.a.createElement("img",{className:we("logo"),src:ge.a,alt:"\u0441\u043b\u0435\u043f\u044b\u0435 \u0441\u043e\u0441\u0430\u0442\u044c"}),r.a.createElement("form",{onSubmit:function(t){return function(t){t.preventDefault(),e(R.auth({login:a,password:n}))}(t)},className:we("input-form")},r.a.createElement("div",{className:we("login")},r.a.createElement(pe.a,{className:we("login-input")+" "+we("input"),name:"login",component:"input",placeholder:"\u041b\u043e\u0433\u0438\u043d"})),r.a.createElement(pe.a,{className:we("password-input")+" "+we("input"),name:"password",component:"input",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}),r.a.createElement("button",{className:we("login-button")},"\u0412\u041e\u0419\u0422\u0418"))))})),ve=n(37),je=Object(ve.a)([function(e){return e.news.news}],(function(e){return e})),Ee=(n(284),n(285),n(143)),ye=n.n(Ee),ke=Object(he.cn)("news-post"),Ne=function(e){var t=e.id,n=e.title,a=e.content,c=(e.published,e.loaded,e.source,e.url);e.urlToImage;return r.a.createElement("div",{key:t,className:ke("container")},r.a.createElement("a",{href:c,className:ke("title")},n.match(/BRSM/i)?"\ud83d\udca9":"",n.length>0?n:c,n.match(/BRSM/i)?"\ud83d\udca9":""),r.a.createElement("div",null,r.a.createElement(ye.a,{className:ke("content"),source:a,linkTarget:"_blank",disallowedTypes:["image"]})))},xe=Object(he.cn)("news"),Ae=function(){var e=Object(s.d)();Object(a.useEffect)((function(){e(V.getNews({page:1,newsAtPage:20}))}),[e]);var t=Object(s.e)(je).map((function(e){return r.a.createElement(Ne,e)}));return r.a.createElement("div",{className:xe("container")},t)},Pe=n(69),Se=(n(365),n(25)),ze=Object(he.cn)("header"),Te=function(e){var t=e.location.pathname;return r.a.createElement("div",{className:ze("container")},r.a.createElement(Se.a,{to:"/home",className:ze("logo")},"\u0421\u0442\u0443\u0434\u0435\u043d\u0442 \u0411\u0413\u0423\u0418\u0420"),r.a.createElement("div",{className:ze("menu-container")},r.a.createElement("nav",{className:ze("nav")},r.a.createElement(Se.a,{className:ze("link",{active:"/news"===t}),to:"/news"},"\u041d\u043e\u0432\u043e\u0441\u0442\u0438"),r.a.createElement(Se.a,{className:ze("link",{active:"/erad"===t}),to:"/erad"},"\u042d\u0440\u0443\u0434\u044b"),r.a.createElement(Se.a,{className:ze("link",{active:"/rating"===t}),to:"/rating"},"\u0420\u0435\u0439\u0442\u0438\u043d\u0433"),r.a.createElement(Se.a,{className:ze("link",{active:"/files"===t}),to:"/files"},"\u0424\u0430\u0439\u043b\u044b"),r.a.createElement(Se.a,{className:ze("link",{active:"/free-rooms"===t}),to:"/free-rooms"},"\u0421\u0432\u043e\u0431\u043e\u0434\u043d\u044b\u0435 \u0430\u0443\u0434\u0438\u0442\u043e\u0440\u0438\u0438")),r.a.createElement("span",{className:"profile"})))},Re=function(e){var t=e.component,n=e.isAuthorized,a=Object(Pe.a)(e,["component","isAuthorized"]);return console.log("lol"),r.a.createElement(i.b,Object.assign({},a,{render:function(e){return n?r.a.createElement(r.a.Fragment,null,r.a.createElement(Te,e),r.a.createElement(t,e)):r.a.createElement(i.a,{to:O.EmptyRoute})}}))},De=function(e){var t=e.component,n=e.isAuthorized,a=Object(Pe.a)(e,["component","isAuthorized"]);return r.a.createElement(i.b,Object.assign({},a,{render:function(e){return n?r.a.createElement(i.a,{to:O.MainRoute}):r.a.createElement(r.a.Fragment,null,r.a.createElement(t,e))}}))},Ie=(Object(ve.a)([function(e){return e.auth.userId}],(function(e){return e})),Object(ve.a)([function(e){return e.auth}],(function(e){return!!e.token}))),Fe=function(){Object(s.d)();return"asdf"};var Me=Object(s.c)((function(e){return{isAuthorized:Ie(e)}}))((function(e){var t=e.isAuthorized,n=e.location;return r.a.createElement("div",{className:"theme"},r.a.createElement(I.a,null),r.a.createElement(i.d,{location:n},r.a.createElement(De,{exact:!0,path:"/",component:Oe,isAuthorized:t}),r.a.createElement(Re,{path:O.MainRoute,component:Ae,isAuthorized:t,withNavigation:!0}),r.a.createElement(Re,{path:O.FreeRooms,component:Fe,isAuthorized:t,withNavigation:!0}),r.a.createElement(Re,{path:O.Erud,component:Ae,isAuthorized:t,withNavigation:!0}),r.a.createElement(Re,{path:O.Files,component:Ae,isAuthorized:t,withNavigation:!0}),r.a.createElement(Re,{path:O.Rating,component:Ae,isAuthorized:t,withNavigation:!0}),r.a.createElement(i.a,{to:O.MainRoute})))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(s.a,{store:le},r.a.createElement(ce.a,{history:ie},r.a.createElement(i.c,{history:ie},r.a.createElement(Me,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[146,1,2]]]);
//# sourceMappingURL=main.17da46c5.chunk.js.map